<!DOCTYPE html>
<!-- prettier-ignore -->
<html>
    <head>
        <title>zig.run</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js" data-manual></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-css.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-zig.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-okaidia.min.css" rel="stylesheet" />
        <style>
            body { margin: 0; background-color: #999;}
            #content { width: 100vw; height: 100vh; }
            .zig-snippet { display: flex; justify-content: center; align-items: center; height: 100%; }
            .zig-snippet > pre { min-width: 50vw; min-height: 50vh; }
        </style>
    </head>
    <body>
        <div id="content">
            <div class="zig-snippet">
                <pre><button>RUN</button>&nbsp;<button>RESET</button><br/><br/><code class="language-zig"></code>
                <script>
                    let url = `http://penguin.linux.test:8080/bin/play.cgi?base64=Y29uc3Qgc3RkID0gQGltcG9ydCgic3RkIik7CmNvbnN0IHByaW50ID0gc3RkLmRlYnVnLnByaW50OwoKcHViIGZuIG1haW4oKSAhdm9pZCB7CiAgICBwcmludCgie31cbiIsIC57ImhlbGxvIHdvcmxkISJ9KTsKfQo=`;
                    let zig = atob(url.split('base64=')[1]);
                    let children = Array.from(document.currentScript.parentElement.children);
                    let code = children.find((e) => e.tagName == 'CODE'); let run = children.find((e) => e.tagName == 'BUTTON' && e.textContent == 'RUN'); let reset = children.find((e) => e.tagName == 'BUTTON' && e.textContent == 'RESET');
                    let output = (t) => new Promise((resolve) => { code.textContent = t; resolve(); });
                    run.onclick = () => output('Running...').then(fetch(url).then(r => r.json()).then(t => output(t.stdout + '\n----------\n' + t.stderr)));
                    reset.onclick = () => output(zig).then(() => Prism && Prism.highlightElement(code));
                    output(zig).then(() => Prism && Prism.highlightElement(code));
                </script>
                </pre>
            </div>
        </div>
    </body>
</html>
